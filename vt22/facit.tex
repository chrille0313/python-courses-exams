% Created 2023-10-16 Mon 17:32
% Intended LaTeX compiler: xelatex
\documentclass[11pt]{article}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{unicode-math}
\usepackage{capt-of}
\usepackage{hyperref}
\author{Jean-Philippe Bernardy}
\date{\today}
\title{DAT445 Exam, March 2022}
\hypersetup{
 pdfauthor={Jean-Philippe Bernardy},
 pdftitle={DAT445 Exam, March 2022},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 29.1 (Org mode 9.6.7)}, 
 pdflang={English}}
\begin{document}

\maketitle

\section{Question 1}
\label{sec:org8c3b1da}
Four times a year Sweden tests its system for important messages to the public, i.e. VMA (Viktigt
Meddelande till Allm√§nheten) also known as Hesa Fredrik. The system is tested at 15:00 on the
first holiday-free Monday of March, June, September and December.
Write a program which asks the user for the current month name (January, February, etc) and the
current day of the week (Monday, Tuesday, etc). If the month is one of the four mentioned above
and the day is Monday, the program should also ask if this is the first holiday-free Monday. If the
answer is yes, then the program must print a message that the VMA must be tested, otherwise it
must print that no testing should be done.
Example dialogs:

\begin{verbatim}
Current month? March
Day of the week? Monday
Is that the first holiday-free Monday? yes
Test the VMA at 15:00!
\end{verbatim}

\begin{verbatim}
Current month? June
Day of the week? Tuesday
No testing today!
\end{verbatim}

You can choose to implement the interface in either English or Swedish and correspondingly the
day and month names should be interpreted in the correct language

\subsection{Answer}
\label{sec:org21ba196}

\begin{verbatim}
def query():
    month = input("Current month?").lower()
    day = input("Day of the week?").lower()
    if month in ["march", "june", "september","december"] and day == "monday":
        hfm = input("Is that the first holiday-free Monday?").lower()
        return hfm == "yes"
    else:
        return False

if query():
    print("Test the VMA at 15:00!")
else:
    print("No testing today")
\end{verbatim}

\section{Question 2}
\label{sec:org0db8fa3}


John Doe is using the file "my\textsubscript{groceries.txt}" to store the list of groceries that he keeps at home.
The following is an example of the file content:
\begin{verbatim}
flour 1 2
sugar 3 2
salt 1 2
blue cheese 1 3
tomato 2 2
\end{verbatim}
On every line there is the name of a food product, followed by two quantities - how many
packages of that product he has, and how many he wants to have. For example, currently he has
only 1 package of flour but he wants to have 2. The name of a product may consist of several
words but the two quantities are always the last two words on every line.
Implement the function shoppingList() which reads the file and prints a shopping list. The list must
contain the names of all products that he needs to buy as well as the required quantity. For the
example above, the function must print:
\begin{verbatim}
flour 1
salt 1
blue cheese 2
\end{verbatim}
He needs to buy one package of flour, one of salt, and two of blue cheese, to fill in his supplies.
He has more sugar than he needs and just enough tomatoes, so they are not included in the
shopping list.

\subsection{Answer}
\label{sec:org07f3346}

\begin{verbatim}
with open("my_groceries.txt") as f:
  for line in f:
    fields = line.split()
    n = len(fields)
    if n < 3:
        print("Invalid line:", line)
    else:
      want = int(fields[-1].strip())
      have = int(fields[-2].strip())
    if want > have:
      print(" ".join(fields[0:-2]),want - have)
\end{verbatim}

\begin{verbatim}
flour 1
salt 1
blue cheese 2
\end{verbatim}

\section{Question 3}
\label{sec:org3e63f11}

Implement the class Tracker which is used for tracking the GPS positions of different objects. The
class must have the following methods:
\begin{enumerate}
\item An \uline{\uline{init}} method which initializes a tracker with no pre-existing tracking information. (3 points)
\item A method addPosition(object\textsubscript{name}, latitude, longitude) which adds the current GPS
\end{enumerate}
position (latitude and longitude) for the object with the given name. (4 points)
\begin{enumerate}
\item A method printPath(object\textsubscript{name}) which prints the path traveled by the given object. The
\end{enumerate}
path is simply the sequence of GPS coordinates visited by the object. (4 points)
\begin{enumerate}
\item A method pathLength(object\textsubscript{name}) which returns the total length of the path traversed by
\end{enumerate}
the object. The total length is the sum of the lengths of the lines between every two
consequent GPS coordinates. If there are less than two GPS positions for an object, then
the total length is 0. The length of a line between two GPS positions is computed by using
the haversine function given bellow. (6 points)

\begin{verbatim}
from math import *
def haversine(lat1, lon1, lat2, lon2):
  R = 6372.8
  dLat = radians(lat2 - lat1)
  dLon = radians(lon2 - lon1)
  lat1 = radians(lat1)
  lat2 = radians(lat2)
  a = sin(dLat/2)**2 + cos(lat1)*cos(lat2)*sin(dLon/2)**2
  c = 2*asin(sqrt(a))
  return R * c
\end{verbatim}

The following is an example for how the class Tracker can be used:

\begin{verbatim}
from q3 import Tracker

tr = Tracker()
tr.addPosition("A",32.0004311,-103.548851)
tr.addPosition("A",33.374939,-103.6041946)
tr.addPosition("A",31.102422,-105.9668979)
tr.addPosition("SB Multisal",57.68633,11.97719)
tr.printPath("A")
print(tr.pathLength("A"))
tr.printPath("SB Multisal")
print(tr.pathLength("SB Multisal"))
\end{verbatim}

\begin{verbatim}
32.0004311 -103.548851
33.374939 -103.6041946
31.102422 -105.9668979
489.54312772451726
57.68633 11.97719
0
\end{verbatim}

\subsection{Answer}
\label{sec:org8ed4973}

\begin{verbatim}
from math import (radians,sin,cos,asin,sqrt)
def haversine(lat1, lon1, lat2, lon2):
  R = 6372.8
  dLat = radians(lat2 - lat1)
  dLon =radians(lon2 - lon1)
  lat1 = radians(lat1)
  lat2 = radians(lat2)
  a = sin(dLat/2)**2 + cos(lat1)*cos(lat2)*sin(dLon/2)**2
  c = 2*asin(sqrt(a))
  return R * c

class Tracker:
    def __init__(self):
        self.info = {}
    def addPosition(self, object_name, latitude, longitude):
        path = self.info.setdefault(object_name,[])
        path.append((latitude,longitude))
        # [object_name] = 
    def printPath(self, object_name):
        for (lat,long) in self.info.get(object_name,[]):
            print(lat,long)
    def pathLength(self,object_name):
        path = self.info.get(object_name,[])
        total = 0
        if len(path) > 1:
            prev = path[0]
            for cur in path[1:]:
                (lat1,lon1) = prev
                (lat2,lon2) = cur
                total += haversine(lat1, lon1, lat2, lon2)
                prev = cur
        return total
\end{verbatim}
\end{document}